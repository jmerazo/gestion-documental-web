!function(){function t(){this.renderToDataset=this.renderToDataset.bind(this)}if("undefined"==typeof Chart)console.error("Can not find Chart object.");else{"function"!=typeof Object.assign&&(Object.assign=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])}return o});var e={};["pie","doughnut","polarArea","bar"].forEach(function(t){e[t]=!0}),t.prototype.setup=function(t,e){this.chart=t,this.ctx=t.ctx,this.args={},this.barTotal={};var o=t.config.options;this.options=Object.assign({position:"default",precision:0,fontSize:o.defaultFontSize,fontColor:o.defaultFontColor,fontStyle:o.defaultFontStyle,fontFamily:o.defaultFontFamily,shadowOffsetX:3,shadowOffsetY:3,shadowColor:"rgba(0,0,0,0.3)",shadowBlur:6,images:[],outsidePadding:2,textMargin:2,overlap:!0},e),"bar"===t.config.type&&(this.options.position="default",this.options.arc=!1,this.options.overlap=!0)},t.prototype.render=function(){this.labelBounds=[],this.chart.data.datasets.forEach(this.renderToDataset)},t.prototype.renderToDataset=function(t,e){this.totalPercentage=0,this.total=null;var o=this.args[e];o.meta.data.forEach(function(e,i){this.renderToElement(t,o,e,i)}.bind(this))},t.prototype.renderToElement=function(t,e,o,i){if(this.shouldRenderToElement(e.meta,o)&&(this.percentage=null,e=this.getLabel(t,o,i))){var n=this.ctx;n.save(),n.font=Chart.helpers.fontString(this.options.fontSize,this.options.fontStyle,this.options.fontFamily);var r=this.getRenderInfo(o,e);this.drawable(o,e,r)&&(n.beginPath(),n.fillStyle=this.getFontColor(t,o,i),this.renderLabel(e,r)),n.restore()}},t.prototype.renderLabel=function(t,e){return this.options.arc?this.renderArcLabel(t,e):this.renderBaseLabel(t,e)},t.prototype.renderBaseLabel=function(t,e){var o=this.ctx;if("object"==typeof t)o.drawImage(t,e.x-t.width/2,e.y-t.height/2,t.width,t.height);else{o.save(),o.textBaseline="top",o.textAlign="center",this.options.textShadow&&(o.shadowOffsetX=this.options.shadowOffsetX,o.shadowOffsetY=this.options.shadowOffsetY,o.shadowColor=this.options.shadowColor,o.shadowBlur=this.options.shadowBlur);for(var i=t.split("\n"),n=0;n<i.length;n++)o.fillText(i[n],e.x,e.y-this.options.fontSize/2*i.length+this.options.fontSize*n);o.restore()}},t.prototype.renderArcLabel=function(t,e){var o=this.ctx,i=e.radius,n=e.view;if(o.save(),o.translate(n.x,n.y),"string"==typeof t){o.rotate(e.startAngle),o.textBaseline="middle",o.textAlign="left",n=t.split("\n");var r=0,a=[],s=0;"border"===this.options.position&&(s=(n.length-1)*this.options.fontSize/2);for(var h=0;h<n.length;++h){var l=o.measureText(n[h]);l.width>r&&(r=l.width),a.push(l.width)}for(h=0;h<n.length;++h){var f=n[h],p=(n.length-1-h)*-this.options.fontSize+s;o.save(),o.rotate((r-a[h])/2/i);for(var d=0;d<f.length;d++){var c=f.charAt(d);l=o.measureText(c),o.save(),o.translate(0,-1*i),o.fillText(c,0,p),o.restore(),o.rotate(l.width/i)}o.restore()}}else o.rotate((n.startAngle+Math.PI/2+e.endAngle)/2),o.translate(0,-1*i),this.renderLabel(t,{x:0,y:0});o.restore()},t.prototype.shouldRenderToElement=function(t,e){return!t.hidden&&!e.hidden&&(this.options.showZero||"polarArea"===this.chart.config.type?0!==e._view.outerRadius:0!==e._view.circumference)},t.prototype.getLabel=function(t,e,o){if("function"==typeof this.options.render)t=this.options.render({label:this.chart.config.data.labels[o],value:t.data[o],percentage:this.getPercentage(t,e,o),dataset:t,index:o});else switch(this.options.render){case"value":t=t.data[o];break;case"label":t=this.chart.config.data.labels[o];break;case"image":t=this.options.images[o]?this.loadImage(this.options.images[o]):"";break;default:t=this.getPercentage(t,e,o)+"%"}return"object"==typeof t?t=this.loadImage(t):null!==t&&void 0!==t&&(t=t.toString()),t},t.prototype.getFontColor=function(t,e,o){var i=this.options.fontColor;return"function"==typeof i?i=i({label:this.chart.config.data.labels[o],value:t.data[o],percentage:this.getPercentage(t,e,o),backgroundColor:t.backgroundColor[o],dataset:t,index:o}):"string"!=typeof i&&(i=i[o]||this.chart.config.options.defaultFontColor),i},t.prototype.getPercentage=function(t,e,o){if(null!==this.percentage)return this.percentage;if("polarArea"===this.chart.config.type){if(null===this.total)for(e=this.total=0;e<t.data.length;++e)this.total+=t.data[e];t=t.data[o]/this.total*100}else if("bar"===this.chart.config.type){if(void 0===this.barTotal[o])for(e=this.barTotal[o]=0;e<this.chart.data.datasets.length;++e)this.barTotal[o]+=this.chart.data.datasets[e].data[o];t=t.data[o]/this.barTotal[o]*100}else t=e._view.circumference/this.chart.config.options.circumference*100;return t=parseFloat(t.toFixed(this.options.precision)),this.options.showActualPercentages||("bar"===this.chart.config.type&&(this.totalPercentage=this.barTotalPercentage[o]||0),this.totalPercentage+=t,100<this.totalPercentage&&(t-=this.totalPercentage-100,t=parseFloat(t.toFixed(this.options.precision))),"bar"===this.chart.config.type&&(this.barTotalPercentage[o]=this.totalPercentage)),this.percentage=t},t.prototype.getRenderInfo=function(t,e){return"bar"===this.chart.config.type?this.getBarRenderInfo(t,e):this.options.arc?this.getArcRenderInfo(t,e):this.getBaseRenderInfo(t,e)},t.prototype.getBaseRenderInfo=function(t,e){if("outside"===this.options.position||"border"===this.options.position){var o,i=t._view,n=i.startAngle+(i.endAngle-i.startAngle)/2,r=i.outerRadius/2;return"border"===this.options.position?o=(i.outerRadius-r)/2+r:"outside"===this.options.position&&(o=i.outerRadius-r+r+this.options.textMargin),o={x:i.x+Math.cos(n)*o,y:i.y+Math.sin(n)*o},"outside"===this.options.position&&(n=this.options.textMargin+this.measureLabel(e).width/2,o.x+=o.x<i.x?-n:n),o}return t.tooltipPosition()},t.prototype.getArcRenderInfo=function(t,e){var o=t._view,i="outside"===this.options.position?o.outerRadius+this.options.fontSize+this.options.textMargin:"border"===this.options.position?(o.outerRadius/2+o.outerRadius)/2:(o.innerRadius+o.outerRadius)/2,n=o.startAngle,r=o.endAngle,a=r-n;return n+=Math.PI/2,r+=Math.PI/2,n+=(r-(this.measureLabel(e).width/i+n))/2,{radius:i,startAngle:n,endAngle:r,totalAngle:a,view:o}},t.prototype.getBarRenderInfo=function(t,e){var o=t.tooltipPosition();return o.y-=this.measureLabel(e).height/2+this.options.textMargin,o},t.prototype.drawable=function(t,e,o){if(this.options.overlap)return!0;if(this.options.arc)return o.endAngle-o.startAngle<=o.totalAngle;var i=this.measureLabel(e);e=o.x-i.width/2;var n=o.x+i.width/2,r=o.y-i.height/2;return o=o.y+i.height/2,"outside"===this.options.renderInfo?this.outsideInRange(e,n,r,o):t.inRange(e,r)&&t.inRange(e,o)&&t.inRange(n,r)&&t.inRange(n,o)},t.prototype.outsideInRange=function(t,e,o,i){for(var n=this.labelBounds,r=0;r<n.length;++r){for(var a=n[r],s=[[t,o],[t,i],[e,o],[e,i]],h=0;h<s.length;++h){var l=s[h][0],f=s[h][1];if(l>=a.left&&l<=a.right&&f>=a.top&&f<=a.bottom)return!1}for(s=[[a.left,a.top],[a.left,a.bottom],[a.right,a.top],[a.right,a.bottom]],h=0;h<s.length;++h)if(l=s[h][0],f=s[h][1],l>=t&&l<=e&&f>=o&&f<=i)return!1}return n.push({left:t,right:e,top:o,bottom:i}),!0},t.prototype.measureLabel=function(t){if("object"==typeof t)return{width:t.width,height:t.height};var e=0;t=t.split("\n");for(var o=0;o<t.length;++o){var i=this.ctx.measureText(t[o]);i.width>e&&(e=i.width)}return{width:e,height:this.options.fontSize*t.length}},t.prototype.loadImage=function(t){var e=new Image;return e.src=t.src,e.width=t.width,e.height=t.height,e},Chart.plugins.register({id:"labels",beforeDatasetsUpdate:function(o,i){if(e[o.config.type]){Array.isArray(i)||(i=[i]);var n=i.length;o._labels&&n===o._labels.length||(o._labels=i.map(function(){return new t}));for(var r=!1,a=0,s=0;s<n;++s){var h=o._labels[s];h.setup(o,i[s]),"outside"===h.options.position&&(r=!0,(h=1.5*h.options.fontSize+h.options.outsidePadding)>a&&(a=h))}r&&(o.chartArea.top+=a,o.chartArea.bottom-=a)}},afterDatasetUpdate:function(t,o,i){e[t.config.type]&&t._labels.forEach(function(t){t.args[o.index]=o})},beforeDraw:function(t){e[t.config.type]&&t._labels.forEach(function(t){t.barTotalPercentage={}})},afterDatasetsDraw:function(t){e[t.config.type]&&t._labels.forEach(function(t){t.render()})}})}}();